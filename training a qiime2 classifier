#reference websites
#https://docs.qiime2.org/2022.2/tutorials/feature-classifier/
#https://forum.qiime2.org/t/building-a-coi-database-from-bold-references/16129

Required files:
1) taxa-specific reference database generated by yourself or others(85_otus.fasta)
2) a taxonomy file with the corresponding taxonomic classifications of database (85_otu_taxonomy.txt)
*optional*
3) primer sequences, "It has been shown that taxonomic classification accuracy of 16S rRNA gene sequences
#improves when a Naive Bayes classifier is trained on only the region of the target sequences that was sequenced (Werner et al., 2012)."

#import reference reads (database)
qiime tools import \
  --type 'FeatureData[Sequence]' \
  --input-path 85_otus.fasta \
  --output-path 85_otus.qza

#import taxonomy file
qiime tools import \
  --type 'FeatureData[Taxonomy]' \
  --input-format HeaderlessTSVTaxonomyFormat \
  --input-path 85_otu_taxonomy.txt \
  --output-path ref-taxonomy.qza
  
  #extract locus specific reference reads
  qiime feature-classifier extract-reads \
  --i-sequences 85_otus.qza \
  --p-f-primer GTGCCAGCMGCCGCGGTAA \
  --p-r-primer GGACTACHVGGGTWTCTAAT \
  --p-trunc-len 120 \
  --p-min-length 100 \
  --p-max-length 400 \
  --o-reads ref-seqs.qza
  
  #train the classifier
  qiime feature-classifier fit-classifier-naive-bayes \
  --i-reference-reads ref-seqs.qza \
  --i-reference-taxonomy ref-taxonomy.qza \
  --o-classifier classifier.qza
